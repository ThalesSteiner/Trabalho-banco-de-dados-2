CREATE SCHEMA IF NOT EXISTS n;

-- O summonerId existe independente da partida.
CREATE TABLE n.ContaJogador (
    summonerId VARCHAR(100) PRIMARY KEY
);


-- O Campeao (Personagem do jogo) existe independente de quem joga.
CREATE TABLE n.Campeao (
    championID SERIAL PRIMARY KEY
    championName VARCHAR(50) NOT NULL UNIQUE 
);


CREATE TABLE n.Partida (
    GameID VARCHAR(50) PRIMARY KEY,
    GameMode VARCHAR(10) NOT NULL CHECK (GameMode IN ('ARAM','CLASSIC'))
    timePlayed INT NOT NULL 
);



CREATE TABLE n.Time (
    GameID VARCHAR(50) NOT NULL,
    teamId INT NOT NULL CHECK (teamId IN (100,200)),
    win BOOLEAN,
    teamEarlySurrendered BOOLEAN,
    gameEndedInSurrender BOOLEAN,
    nexusLost INT CHECK (nexusLost IN (0,1)),
    inhibitorsLost INT CHECK (inhibitorsLost BETWEEN 0 AND 6),
    turretsLost INT,
    PRIMARY KEY (GameID, teamId),
    FOREIGN KEY (GameID) REFERENCES n.Partida(GameID)
);


-- Liga a Partida + O Jogador (Summoner) + O Personagem (Campeao)
CREATE TABLE n.Participacao (
    GameID VARCHAR(50) NOT NULL,
    summonerId VARCHAR(100) NOT NULL,
    championID INT NOT NULL,    
    teamId INT NOT NULL,    
    individualPosition VARCHAR(7) CHECK (individualPosition IN ('TOP','MIDDLE','BOTTOM','JUNGLE','UTILITY','INVALID')),